<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Security Gateway - Project Showcase</title>
  <meta name="description"
    content="Advanced API security platform with OAuth2, rate limiting, DDoS protection, and threat detection.">
  <link rel="stylesheet" href="../../styles.css?v=2">
    <link rel="stylesheet" href="../../safari-firefox-fix.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;800&display=swap"
    rel="stylesheet">
  <script src="https://unpkg.com/@studio-freight/lenis@1.0.42/dist/lenis.min.js"></script>
</head>

<body>
  <canvas id="bg-canvas"></canvas>

  <div class="project-showcase">
    <a href="../../index.html" class="back-link">‚Üê Back to Portfolio</a>

    <div class="project-header">
      <h1>API Security Gateway</h1>
      <p class="subtitle">Enterprise security platform with OAuth2, DDoS protection, and intelligent threat detection
      </p>

      <div class="project-meta">
        <div class="meta-item">
          <strong>Role:</strong> Security Engineer / Backend Developer
        </div>
        <div class="meta-item">
          <strong>Duration:</strong> 7 Months
        </div>
        <div class="meta-item">
          <strong>Status:</strong> Production
        </div>
      </div>

      <div class="tech-stack">
        <span class="tech-badge">Node.js</span>
        <span class="tech-badge">OAuth2</span>
        <span class="tech-badge">JWT</span>
        <span class="tech-badge">Redis</span>
        <span class="tech-badge">Nginx</span>
        <span class="tech-badge">WAF</span>
        <span class="tech-badge">PostgreSQL</span>
        <span class="tech-badge">Elasticsearch</span>
      </div>

      <div class="cta-buttons">
        <a href="README.md" class="btn-primary" target="_blank">View Documentation</a>
        <a href="https://github.com/sohana30/new-portfolio/tree/main/projects/api-security-gateway"
          class="btn-secondary" target="_blank">Browse Code</a>
      </div>
    </div>

    <div class="project-layout">
      <aside class="project-sidebar">
        <nav class="project-nav">
          <h3>Contents</h3>
          <ul>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#features">Security Features</a></li>
            <li><a href="#authentication">Authentication</a></li>
            <li><a href="#protection">Threat Protection</a></li>
            <li><a href="#challenges">Challenges & Solutions</a></li>
          </ul>
        </nav>
      </aside>

      <div class="project-main">
        <div id="overview" class="content-section">
          <h2>üîí Project Overview</h2>
          <p>Built a comprehensive API security gateway that protects backend services from unauthorized access,
            DDoS attacks, and malicious traffic. The system implements OAuth2/OpenID Connect for authentication,
            multi-tier rate limiting, Web Application Firewall (WAF) rules, and ML-based anomaly detection.
            Processes 2M+ requests daily while blocking 50K+ malicious attempts.</p>

          <div class="metrics-grid">
            <div class="metric-card">
              <span class="metric-value">2M+</span>
              <span class="metric-label">Requests/Day</span>
            </div>
            <div class="metric-card">
              <span class="metric-value">50K+</span>
              <span class="metric-label">Threats Blocked</span>
            </div>
            <div class="metric-card">
              <span class="metric-value">99.99%</span>
              <span class="metric-label">Uptime</span>
            </div>
            <div class="metric-card">
              <span class="metric-value">&lt;5ms</span>
              <span class="metric-label">Auth Overhead</span>
            </div>
          </div>
        </div>

        <div id="features" class="content-section">
          <h2>üõ°Ô∏è Security Features</h2>
          <ul>
            <li><strong>OAuth2 & OpenID Connect:</strong> Industry-standard authentication with multiple grant types
            </li>
            <li><strong>JWT Token Management:</strong> Secure token generation, validation, and refresh mechanisms</li>
            <li><strong>Multi-Tier Rate Limiting:</strong> Per-user, per-IP, and per-endpoint rate limits</li>
            <li><strong>DDoS Protection:</strong> Automatic detection and mitigation of volumetric attacks</li>
            <li><strong>Web Application Firewall:</strong> OWASP Top 10 protection with custom rule engine</li>
            <li><strong>API Key Management:</strong> Secure key generation, rotation, and revocation</li>
            <li><strong>Request Signing:</strong> HMAC-based request authentication for sensitive operations</li>
            <li><strong>Anomaly Detection:</strong> ML-based detection of suspicious traffic patterns</li>
          </ul>
        </div>

        <div id="authentication" class="content-section">
          <h2>üîê Authentication & Authorization</h2>

          <h3>OAuth2 Implementation</h3>
          <div class="challenges-grid">
            <div class="challenge-card">
              <h3>Authorization Code Flow</h3>
              <ul>
                <li>PKCE support for mobile/SPA apps</li>
                <li>State parameter for CSRF protection</li>
                <li>Consent screen for scope approval</li>
                <li>Refresh token rotation</li>
              </ul>
            </div>
            <div class="challenge-card">
              <h3>Client Credentials Flow</h3>
              <ul>
                <li>Machine-to-machine authentication</li>
                <li>Client secret management</li>
                <li>Scope-based access control</li>
                <li>Token introspection endpoint</li>
              </ul>
            </div>
            <div class="challenge-card">
              <h3>JWT Token Structure</h3>
              <ul>
                <li>RS256 signing algorithm</li>
                <li>Custom claims for permissions</li>
                <li>Short-lived access tokens (15 min)</li>
                <li>Long-lived refresh tokens (30 days)</li>
              </ul>
            </div>
            <div class="challenge-card">
              <h3>Token Validation</h3>
              <ul>
                <li>Signature verification with public key</li>
                <li>Expiration and not-before checks</li>
                <li>Issuer and audience validation</li>
                <li>Token revocation list checking</li>
              </ul>
            </div>
          </div>

          <h3>Code Example - JWT Middleware</h3>
          <div class="code-preview">
            <pre>
<span class="comment">// JWT Authentication Middleware</span>
<span class="keyword">const</span> jwt <span class="operator">=</span> <span class="function">require</span>(<span class="string">'jsonwebtoken'</span>);
<span class="keyword">const</span> { promisify } <span class="operator">=</span> <span class="function">require</span>(<span class="string">'util'</span>);

<span class="keyword">class</span> <span class="class-name">JWTMiddleware</span> {
  <span class="function">constructor</span>(publicKey, redisClient) {
    <span class="keyword">this</span>.<span class="property">publicKey</span> <span class="operator">=</span> publicKey;
    <span class="keyword">this</span>.<span class="property">redis</span> <span class="operator">=</span> redisClient;
    <span class="keyword">this</span>.<span class="property">verify</span> <span class="operator">=</span> <span class="function">promisify</span>(jwt.verify);
  }

  <span class="keyword">async</span> <span class="function">authenticate</span>(req, res, next) {
    <span class="keyword">try</span> {
      <span class="comment">// Extract token from Authorization header</span>
      <span class="keyword">const</span> token <span class="operator">=</span> <span class="keyword">this</span>.<span class="function">extractToken</span>(req);
      <span class="keyword">if</span> (<span class="operator">!</span>token) {
        <span class="keyword">return</span> res.<span class="function">status</span>(<span class="number">401</span>).<span class="function">json</span>({ error: <span class="string">'No token provided'</span> });
      }

      <span class="comment">// Check if token is revoked</span>
      <span class="keyword">const</span> isRevoked <span class="operator">=</span> <span class="keyword">await</span> <span class="keyword">this</span>.<span class="property">redis</span>.<span class="function">get</span>(<span class="string">`revoked:${token}`</span>);
      <span class="keyword">if</span> (isRevoked) {
        <span class="keyword">return</span> res.<span class="function">status</span>(<span class="number">401</span>).<span class="function">json</span>({ error: <span class="string">'Token has been revoked'</span> });
      }

      <span class="comment">// Verify token signature and claims</span>
      <span class="keyword">const</span> decoded <span class="operator">=</span> <span class="keyword">await</span> <span class="keyword">this</span>.<span class="function">verify</span>(token, <span class="keyword">this</span>.<span class="property">publicKey</span>, {
        algorithms: [<span class="string">'RS256'</span>],
        issuer: <span class="string">'api-gateway'</span>,
        audience: <span class="string">'api-services'</span>
      });

      <span class="comment">// Check permissions</span>
      <span class="keyword">if</span> (<span class="operator">!</span><span class="keyword">this</span>.<span class="function">hasRequiredPermissions</span>(decoded, req.route)) {
        <span class="keyword">return</span> res.<span class="function">status</span>(<span class="number">403</span>).<span class="function">json</span>({ error: <span class="string">'Insufficient permissions'</span> });
      }

      <span class="comment">// Attach user info to request</span>
      req.user <span class="operator">=</span> {
        id: decoded.sub,
        email: decoded.email,
        permissions: decoded.permissions,
        tokenId: decoded.jti
      };

      <span class="function">next</span>();
    } <span class="keyword">catch</span> (error) {
      <span class="keyword">if</span> (error.name <span class="operator">===</span> <span class="string">'TokenExpiredError'</span>) {
        <span class="keyword">return</span> res.<span class="function">status</span>(<span class="number">401</span>).<span class="function">json</span>({ error: <span class="string">'Token expired'</span> });
      }
      <span class="keyword">return</span> res.<span class="function">status</span>(<span class="number">401</span>).<span class="function">json</span>({ error: <span class="string">'Invalid token'</span> });
    }
  }

  <span class="function">extractToken</span>(req) {
    <span class="keyword">const</span> authHeader <span class="operator">=</span> req.headers.authorization;
    <span class="keyword">if</span> (authHeader <span class="operator">&amp;&amp;</span> authHeader.<span class="function">startsWith</span>(<span class="string">'Bearer '</span>)) {
      <span class="keyword">return</span> authHeader.<span class="function">substring</span>(<span class="number">7</span>);
    }
    <span class="keyword">return</span> <span class="keyword">null</span>;
  }

  <span class="function">hasRequiredPermissions</span>(decoded, route) {
    <span class="keyword">const</span> requiredPermissions <span class="operator">=</span> route.permissions <span class="operator">||</span> [];
    <span class="keyword">const</span> userPermissions <span class="operator">=</span> decoded.permissions <span class="operator">||</span> [];
    <span class="keyword">return</span> requiredPermissions.<span class="function">every</span>(p <span class="operator">=&gt;</span> userPermissions.<span class="function">includes</span>(p));
  }
}</pre>
          </div>
        </div>

        <div id="protection" class="content-section">
          <h2>üõ°Ô∏è Threat Protection</h2>

          <h3>Rate Limiting Strategy</h3>
          <div class="code-preview">
            <pre>
<span class="comment">// Sliding Window Rate Limiter</span>
<span class="keyword">class</span> <span class="class-name">SlidingWindowRateLimiter</span> {
  <span class="function">constructor</span>(redisClient) {
    <span class="keyword">this</span>.<span class="property">redis</span> <span class="operator">=</span> redisClient;
  }

  <span class="keyword">async</span> <span class="function">checkLimit</span>(identifier, limit, windowMs) {
    <span class="keyword">const</span> now <span class="operator">=</span> <span class="class-name">Date</span>.<span class="function">now</span>();
    <span class="keyword">const</span> windowStart <span class="operator">=</span> now <span class="operator">-</span> windowMs;
    <span class="keyword">const</span> key <span class="operator">=</span> <span class="string">`ratelimit:${identifier}`</span>;

    <span class="comment">// Remove old entries outside window</span>
    <span class="keyword">await</span> <span class="keyword">this</span>.<span class="property">redis</span>.<span class="function">zremrangebyscore</span>(key, <span class="number">0</span>, windowStart);

    <span class="comment">// Count requests in current window</span>
    <span class="keyword">const</span> count <span class="operator">=</span> <span class="keyword">await</span> <span class="keyword">this</span>.<span class="property">redis</span>.<span class="function">zcard</span>(key);

    <span class="keyword">if</span> (count <span class="operator">&gt;=</span> limit) {
      <span class="keyword">const</span> oldestRequest <span class="operator">=</span> <span class="keyword">await</span> <span class="keyword">this</span>.<span class="property">redis</span>.<span class="function">zrange</span>(key, <span class="number">0</span>, <span class="number">0</span>, <span class="string">'WITHSCORES'</span>);
      <span class="keyword">const</span> resetTime <span class="operator">=</span> <span class="function">parseInt</span>(oldestRequest[<span class="number">1</span>]) <span class="operator">+</span> windowMs;
      
      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="class-name">RateLimitError</span>({
        limit,
        remaining: <span class="number">0</span>,
        resetAt: <span class="keyword">new</span> <span class="class-name">Date</span>(resetTime)
      });
    }

    <span class="comment">// Add current request</span>
    <span class="keyword">await</span> <span class="keyword">this</span>.<span class="property">redis</span>.<span class="function">zadd</span>(key, now, <span class="string">`${now}:${Math.random()}`</span>);
    <span class="keyword">await</span> <span class="keyword">this</span>.<span class="property">redis</span>.<span class="function">pexpire</span>(key, windowMs);

    <span class="keyword">return</span> {
      limit,
      remaining: limit <span class="operator">-</span> count <span class="operator">-</span> <span class="number">1</span>,
      resetAt: <span class="keyword">new</span> <span class="class-name">Date</span>(now <span class="operator">+</span> windowMs)
    };
  }
}

<span class="comment">// Multi-tier rate limiting</span>
app.<span class="function">use</span>(<span class="keyword">async</span> (req, res, next) <span class="operator">=&gt;</span> {
  <span class="keyword">const</span> limiter <span class="operator">=</span> <span class="keyword">new</span> <span class="class-name">SlidingWindowRateLimiter</span>(redis);
  
  <span class="keyword">try</span> {
    <span class="comment">// Tier 1: Per-IP rate limit (strict)</span>
    <span class="keyword">await</span> limiter.<span class="function">checkLimit</span>(
      <span class="string">`ip:${req.ip}`</span>, 
      <span class="number">1000</span>,  <span class="comment">// 1000 requests</span>
      <span class="number">60000</span>  <span class="comment">// per minute</span>
    );
    
    <span class="comment">// Tier 2: Per-user rate limit (if authenticated)</span>
    <span class="keyword">if</span> (req.user) {
      <span class="keyword">await</span> limiter.<span class="function">checkLimit</span>(
        <span class="string">`user:${req.user.id}`</span>,
        <span class="number">5000</span>,   <span class="comment">// 5000 requests</span>
        <span class="number">60000</span>   <span class="comment">// per minute</span>
      );
    }
    
    <span class="comment">// Tier 3: Per-endpoint rate limit</span>
    <span class="keyword">await</span> limiter.<span class="function">checkLimit</span>(
      <span class="string">`endpoint:${req.path}`</span>,
      <span class="number">10000</span>,  <span class="comment">// 10000 requests</span>
      <span class="number">60000</span>   <span class="comment">// per minute</span>
    );
    
    <span class="function">next</span>();
  } <span class="keyword">catch</span> (error) {
    <span class="keyword">if</span> (error <span class="keyword">instanceof</span> <span class="class-name">RateLimitError</span>) {
      res.<span class="function">set</span>({
        <span class="string">'X-RateLimit-Limit'</span>: error.limit,
        <span class="string">'X-RateLimit-Remaining'</span>: error.remaining,
        <span class="string">'X-RateLimit-Reset'</span>: error.resetAt.<span class="function">toISOString</span>()
      });
      <span class="keyword">return</span> res.<span class="function">status</span>(<span class="number">429</span>).<span class="function">json</span>({
        error: <span class="string">'Too many requests'</span>,
        retryAfter: error.resetAt
      });
    }
    <span class="function">next</span>(error);
  }
});</pre>
          </div>

          <h3>WAF Rules & DDoS Protection</h3>
          <div class="challenges-grid">
            <div class="challenge-card">
              <h3>SQL Injection Prevention</h3>
              <ul>
                <li>Pattern matching for SQL keywords</li>
                <li>Parameterized query enforcement</li>
                <li>Input sanitization and validation</li>
                <li>Automatic request blocking and logging</li>
              </ul>
            </div>
            <div class="challenge-card">
              <h3>XSS Protection</h3>
              <ul>
                <li>Content Security Policy headers</li>
                <li>HTML entity encoding</li>
                <li>Script tag detection and blocking</li>
                <li>Reflected XSS prevention</li>
              </ul>
            </div>
            <div class="challenge-card">
              <h3>DDoS Mitigation</h3>
              <ul>
                <li>Connection rate limiting</li>
                <li>Slowloris attack detection</li>
                <li>IP reputation checking</li>
                <li>Automatic IP blacklisting</li>
              </ul>
            </div>
            <div class="challenge-card">
              <h3>Bot Detection</h3>
              <ul>
                <li>User-Agent analysis</li>
                <li>Behavioral fingerprinting</li>
                <li>CAPTCHA challenges for suspicious traffic</li>
                <li>Honeypot endpoints</li>
              </ul>
            </div>
          </div>
        </div>

        <div id="challenges" class="content-section">
          <h2>‚ö° Challenges & Solutions</h2>
          <div class="challenges-grid">
            <div class="challenge-card">
              <h3>Token Storage Security</h3>
              <p>Securing refresh tokens while maintaining performance for high-traffic API.</p>
              <div class="solution-block">
                <h4>Solution</h4>
                <p>Implemented token rotation with Redis-backed storage. Refresh tokens are hashed before storage and
                  automatically rotated on each use. Added token family tracking to detect token theft and revoke entire
                  token families when suspicious activity is detected.</p>
              </div>
            </div>
            <div class="challenge-card">
              <h3>Distributed Rate Limiting</h3>
              <p>Maintaining accurate rate limits across multiple gateway instances.</p>
              <div class="solution-block">
                <h4>Solution</h4>
                <p>Used Redis with sliding window algorithm for distributed rate limiting. Implemented Lua scripts for
                  atomic operations ensuring accuracy even under high concurrency. Added local caching layer to reduce
                  Redis load by 60%.</p>
              </div>
            </div>
            <div class="challenge-card">
              <h3>False Positive Reduction</h3>
              <p>WAF rules blocking legitimate traffic while trying to catch attacks.</p>
              <div class="solution-block">
                <h4>Solution</h4>
                <p>Built ML model trained on historical traffic patterns to distinguish legitimate from malicious
                  requests. Implemented confidence scoring system where low-confidence blocks trigger manual review.
                  Reduced false positives by 85% while maintaining 99% threat detection rate.</p>
              </div>
            </div>
            <div class="challenge-card">
              <h3>Performance Impact</h3>
              <p>Security checks adding latency to every API request.</p>
              <div class="solution-block">
                <h4>Solution</h4>
                <p>Optimized JWT verification by caching public keys and using async validation. Implemented request
                  fingerprinting to skip redundant checks for known-good clients. Reduced authentication overhead from
                  25ms to under 5ms.</p>
              </div>
            </div>
          </div>
        </div>

        <div class="content-section">
          <h2>üìä Security Metrics</h2>
          <ul>
            <li><strong>Threat Detection:</strong> 50K+ malicious requests blocked daily</li>
            <li><strong>False Positive Rate:</strong> Less than 0.1% of legitimate traffic blocked</li>
            <li><strong>DDoS Mitigation:</strong> Successfully mitigated 15+ DDoS attacks</li>
            <li><strong>Authentication Speed:</strong> JWT validation under 5ms</li>
            <li><strong>Compliance:</strong> SOC 2, PCI DSS, and GDPR compliant</li>
          </ul>

          <h3>Monitoring & Alerting</h3>
          <ul>
            <li>Real-time threat dashboard with Grafana</li>
            <li>Elasticsearch for security event logging and analysis</li>
            <li>Automated alerts for anomalous traffic patterns</li>
            <li>Weekly security reports with threat intelligence</li>
            <li>Integration with SIEM systems for enterprise security</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script src="../../script.js"></script>
</body>

</html>